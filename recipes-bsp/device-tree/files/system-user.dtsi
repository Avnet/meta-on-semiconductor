
#include <dt-bindings/media/xilinx-vip.h>
#include <dt-bindings/gpio/gpio.h>


&amba_pl {
   // Remove definitions auto-generated by device tree generator
   /delete-node/interrupt-controller@a0090000; // axi_intc_0
   /delete-node/vcap_CAPTURE_PIPLINE_v_proc_ss_0;
};

&amba {
	axi_intc_0: axi-interrupt-ctrl {
		#interrupt-cells = <2>;
		compatible = "xlnx,xps-intc-1.00.a";
		interrupt-controller;
		reg = <0x0 0xA0090000 0x0 0x1000>;
		xlnx,kind-of-intr = <0x0>;
		xlnx,num-intr-inputs = <0x20>;
		interrupt-parent = <&gic>;
		// connected at PS interrupt offset [6] (89+6=95) 
		interrupts = <0 95 4>;
	};

	zyxclmm_drm {
		compatible = "xlnx,zocl";
		status = "okay";
		interrupt-parent = <&axi_intc_0>;
		interrupts = <0  4>, <1  4>, <2  4>, <3  4>,
			     <4  4>, <5  4>, <6  4>, <7  4>,
			     <8  4>, <9  4>, <10 4>, <11 4>,
			     <12 4>, <13 4>, <14 4>, <15 4>,
			     <16 4>, <17 4>, <18 4>, <19 4>,
			     <20 4>, <21 4>, <22 4>, <23 4>,
			     <24 4>, <25 4>, <26 4>, <27 4>,
			     <28 4>, <29 4>, <30 4>, <31 4>;
	};
};


&amba {
/*
   /delete-node/ axi-interrupt-ctrl;
   /delete-node/ zyxclmm_drm;
*/

	ap1302_osc: ap1302oscillator {
		compatible = "fixed-clock";
		#clock-cells = <0>;
		clock-frequency  = <48000000>;
		clock-output-names = "ap1302osc";
	};
};


/*
&i2c1 {
	i2c-mux@75 {
		reset-gpios = <&gpio 12 1>;
	};
	camera@3c {
		compatible = "onnn,ap1302";
		reg = <0x3c>;

		clocks = <&ap1302_osc>;

		reset-gpios = <&gpio 39 GPIO_ACTIVE_LOW>;
		standby-gpios = <&gpio 44 GPIO_ACTIVE_HIGH>;

		port@0 {
			reg = <0>;
			ias_out0: endpoint {
				remote-endpoint = <&csiss_in>;
				data-lanes = <1 2 3 4>;
			};
		};

		sensors {
			#address-cells = <1>;
			#size-cells = <0>;

			onnn,model = "onnn,ar0144";

			sensor@0 {
				reg = <0>;
			};

			sensor@1 {
				reg = <1>;
			};
		};
	};
};

&amba_pl {
	v_frmbuf_wr@b0010000 {
		reset-gpios = <&GPIO_axi_gpio_0 3 0 1>;
	};
};

&CAPTURE_PIPLINE_mipi_csi2_rx_subsyst_0 {
	ports {
		#address-cells = <1>;
		#size-cells = <0>;

		port@0 {
			reg = <0>;
			xlnx,video-format = <XVIP_VF_YUV_422>;
			xlnx,video-width = <8>;
			csiss_out: endpoint {
				remote-endpoint = <&scaler_in>;
			};
		};
		port@1 {
			reg = <1>;
			xlnx,video-format = <XVIP_VF_YUV_422>;
			xlnx,video-width = <8>;
			csiss_in: endpoint {
				remote-endpoint = <&ias_out0>;
			};
		};
	};
};

&CAPTURE_PIPLINE_v_proc_ss_0 {
	compatible = "xlnx,v-vpss-scaler-2.2";
	reset-gpios = <&GPIO_axi_gpio_0 5 0 1>;
	ports {
		#address-cells = <1>;
		#size-cells = <0>;
		port@0 {
			// For xlnx,video-format user needs to fill as per their requirement
			reg = <0>;
			xlnx,video-format = <XVIP_VF_YUV_422>;
			xlnx,video-width = <8>;
			scaler_in: endpoint {
				remote-endpoint = <&csiss_out>;
			};
		};
		port@1 {
			// For xlnx,video-format user needs to fill as per their requirement
			reg = <1>;
			xlnx,video-format = <XVIP_VF_YUV_422>;
			xlnx,video-width = <8>;
			scaler_out: endpoint {
				remote-endpoint = <&vcap_csi_in>;
			};
		};
	};
};

&amba_pl {
	vcap_csi {
		compatible = "xlnx,video";
		dma-names = "port0";
		dmas = <&CAPTURE_PIPLINE_v_frmbuf_wr_0 0>;
		ports {
			#address-cells = <1>;
			#size-cells = <0>;
			port@0 {
				direction = "input";
				reg = <0>;
				vcap_csi_in: endpoint {
					remote-endpoint = <&scaler_out>;
				};
			};
		};
	};
};
*/


&i2c1 {
	i2c-mux@75 {
		reset-gpios = <&gpio 12 1>;
		i2c@2 {
			camera@3c {
				compatible = "onnn,ap1302";
				reg = <0x3c>;

				clocks = <&ap1302_osc>;

				reset-gpios = <&gpio 39 GPIO_ACTIVE_LOW>;
				standby-gpios = <&gpio 44 GPIO_ACTIVE_HIGH>;

				port@0 {
					reg = <0>;
					ias_out0: endpoint {
						remote-endpoint = <&csiss_in>;
					};
				};

				sensors {
					#address-cells = <1>;
					#size-cells = <0>;

					onnn,model = "onnn,ar0144";

					sensor@0 {
						reg = <0>;
					};

					sensor@1 {
						reg = <1>;
					};
				};
			};
		};
	};
};

&amba {
	ap1302_osc: ap1302oscillator {
		compatible = "fixed-clock";
		#clock-cells = <0>;
		clock-frequency  = <48000000>;
		clock-output-names = "ap1302osc";
	};
};

/ {
	amba_pl: amba_pl@0 {
		CAPTURE_PIPELINE_0_mipi_csi2_rx_subsyst_0: mipi_csi2_rx_subsystem@b0000000 {
			csiss_ports: ports {
				#address-cells = <1>;
				#size-cells = <0>;

				csiss_port0: port@0 {
					reg = <0>;
					xlnx,video-format = <XVIP_VF_YUV_422>;
					xlnx,video-width = <8>;
					csiss_out: endpoint {
						remote-endpoint = <&scaler_in>;
					};
				};
				csiss_port1: port@1 {
					reg = <1>;
					xlnx,video-format = <XVIP_VF_YUV_422>;
					xlnx,video-width = <8>;
					csiss_in: endpoint {
						remote-endpoint = <&ias_out0>;
					};
				};
			};
		};

		CAPTURE_PIPELINE_0_v_proc_ss_0: v_proc_ss@b0040000 {
			compatible = "xlnx,v-vpss-scaler-2.2";
			reset-gpios = <&GPIO_axi_gpio_0 5 0 1>;
			scaler_ports: ports {
				#address-cells = <1>;
				#size-cells = <0>;
				scaler_port0: port@0 {
					/* For xlnx,video-format user needs to fill as per their requirement */
					reg = <0>;
					xlnx,video-format = <XVIP_VF_YUV_422>;
					xlnx,video-width = <8>;
					scaler_in: endpoint {
						remote-endpoint = <&csiss_out>;
					};
				};
				scaler_port1: port@1 {
					/* For xlnx,video-format user needs to fill as per their requirement */
					reg = <1>;
					xlnx,video-format = <XVIP_VF_YUV_422>;
					xlnx,video-width = <8>;
					scaler_out: endpoint {
						remote-endpoint = <&vcap_csi_in>;
					};
				};
			};
		};

		CAPTURE_PIPLINE_v_frmbuf_wr_0: v_frmbuf_wr@b0010000 {
			reset-gpios = <&GPIO_axi_gpio_0 3 0 1>;
		};

		vcap_csi {
			compatible = "xlnx,video";
			dma-names = "port0";
			dmas = <&CAPTURE_PIPLINE_v_frmbuf_wr_0 0>;
			vcap_ports: ports {
				#address-cells = <1>;
				#size-cells = <0>;
				vcap_port: port@0 {
					direction = "input";
					reg = <0>;
					vcap_csi_in: endpoint {
						remote-endpoint = <&scaler_out>;
					};
				};
			};
		};
	};
};
